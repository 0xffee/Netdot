<%perl>
unless ( $ARGS{table} && $ARGS{id} ){
   print "<strong>Missing required parameters 'table' and/or 'id'</strong>";
   exit;
}
$table = $ARGS{table};
$obj = $table->retrieve($ARGS{id});

unless ( $obj ){
   print "<strong>Nonexistent record: $ARGS{id}</strong>";
   exit;
}

%linksto = $ui->getlinksto($table);
%linksfrom = $ui->getlinksfrom($table);
%order = $ui->getcolumnorder($table);

</%perl>


%if ( !exists( $ARGS{submit} ) ){

% my $labelstr = $ui->getobjlabel($obj, ", ");
<& header, title=>" Delete: $table: $labelstr" &>

<table align="center" valign="top" border="0" width="95%">
<tr><td>

<p>
<p>Are you sure you want to delete <% $table %> <strong><% $labelstr %></strong>?

<form method="POST" action="delete.html">

<input type="hidden" name="table" value="<% $table %>">
<input type="hidden" name="id" value="<% $obj->id %>">
<input type="hidden" name="confirm" value="1">
<p>
<input name="submit" value="Proceed" type="submit">
<input name="submit" value="Cancel" type="submit">

</form>

<p><br>
</td></tr>
</table>
<& footer &>


%}elsif ($ARGS{confirm} && $ARGS{submit} eq "Proceed"){

% my $labelstr = $ui->getobjlabel($obj, ", ");
<& header, title=>" Delete: $table: $labelstr" &>

<table align="center" valign="top" border="0" width="95%">
<tr><td>

%# Delete the object
%  my $lbl = $ui->getobjlabel($obj, ", ");
%  eval {
%      $obj->delete;
%      };
% if ($@){
  <& error, caller => "delete.html", error => "$@" &>
%  $m->abort;
% } else{
<strong><% "$table $lbl" %></strong> deleted.
%}

</td></tr>
</table>
<& footer &>

%}elsif ($ARGS{submit} eq "Cancel"){
   <& view.html, table => $table, id => $obj->id &>
%  exit;
%}

<%init>
use lib "/home/netdot/public_html/lib"; 
use Netdot::DBI;
use Netdot::UI;
my $ui = Netdot::UI->new();
my( %linksto, %linksfrom, $table, $obj, $mi, %order);
           
</%init>
