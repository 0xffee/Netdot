<%doc>
Interface for VLAN Groups
</%doc>
%
%
<%attr>
title   => 'VLANs' 
section => 'Management'
</%attr>
%
%
<%args>
$id                => undef
$search            => undef
$_action           => 'SHOW_GROUPS'
</%args>
%
%
<%init>

my $DEBUG = 0;
my $o;
my @list;

print "<pre>", Dumper(%ARGS), "</pre><br>" if $DEBUG;

</%init>

<div id="sectiondetail">

%#######################################################################################
%# Search
%#
%#######################################################################################

% if ( defined $search ){
%    # Remove trailing and leading spaces
%    $search =~ s/^\s*(.*)\s*$/$1/g;

%    if ( $_action eq "SEARCH_VLAN" ){
%        my %idx;
%        map { push @list, $_; $idx{$_->id}++ }  Vlan->search_like(vid=>$search);
%        map { push @list, $_ && $idx{$_->id}++  unless exists $idx{$_->id} } Vlan->search_like(name=>$search);
%        map { push @list, $_ && $idx{$_->id}++  unless exists $idx{$_->id} } Vlan->search_like(description=>$search);
%       

%    }elsif ( $_action eq "SEARCH_VLANGROUP" ) {
%        my %idx;
%        map { push @list, $_; $idx{$_->id}++ }  VlanGroup->search_like(name=>$search);
%        map { push @list, $_ && $idx{$_->id}++  unless exists $idx{$_->id} } VlanGroup->search_like(description=>$search);

%    }
	 <div class="container">
           <div class="containerhead">
              Query <em><% $search %></em> returned: <% scalar(@list) %> matches
           </div>
           <div class="containerbody">
%          if ( @list ){
               <& /generic/sortresults.mhtml, object=>\@list, page=>'view.html', withedit=>0  &>
%          }else{
	       <form action="vlan.html" method="POST">
                 <p>
                 <label for="search"><% $_action %>:</label>
                 <input type="text" name="search" class="txt" value="<% $search %>"> 
                 <input name="submit" value="search" class="btn" type="submit">
                 <input type="hidden" name="_action" value="<% $_action %>">
                 </p>
               </form> 
%         }
          </div>
       </div>
% }

%#######################################################################################
%# Show Groups
%#
%#######################################################################################
%if( $_action eq "SHOW_GROUPS" && !$o ){
    
%    @list = VlanGroup->retrieve_all;
    
      <div class="container">
          <div class="containerbody">
%             if ( @list ){
                  <& /generic/sortresults.mhtml, object => \@list, page=>'view.html', withedit=>0  &>
%             }
          </div>
      </div>
%}
</div> <!-- End sectiondetail -->
