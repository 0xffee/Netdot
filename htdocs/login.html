<%doc>

Login Page

</%doc>

<%attr>
title   => 'Netdot Login' 
</%attr>

<%init>
my $message;
my $redirect_path;
my $main_page = $r->dir_config('NetdotPath') . "/index.html";
my $submit_target = $r->dir_config('NetdotPath') . "/NetdotLogin";
# Unless they requested the login page directly while not logged in
# (in which case prev isn't defined) we tell them why they must login.

if (defined $r->prev) {
    $message = "You are not authorized: "
               . $r->prev->subprocess_env('AuthCookieReason')
               . "<br /><br />";
    $redirect_path = $r->prev->uri . ( $r->prev->args ? "?" . $r->prev->args : "");
    # If they really were just loggin in they probably don't want to
    # continue to login ad nauseum.
    $redirect_path = $main_page if ($redirect_path =~ /login.html/);
} 
</%init>

<div class="sectiondetail">

<!-- 
Use the path as set in the Apache conf for the netdot root so the user
can change the location with out editing any code.  The path needs to
be absolute here since the user could pass any url and get redirected
to login (although right now the only files not at the root are the
images, and possibly a request for /netdot which I think gets
translated to /netdot/ before AuthCookie takes over anyway).
-->

<div id="loginform" align="center">


<div class="container">
    <div class="containerhead">
%#        <% $message %>
%#        <% $redirect_path %><br /><br />
        Please enter your login and password to authenticate.
    </div>
    <div class="containerbody">

      <fieldset class="medium" id="sectiontools" style="border: none">
	
	<form method="post" action="<% $submit_target %>" >
%#	<input type="hidden" name="destination" value="<% $redirect_path %>" />

	<p>
	  <label for="credential_0">Login:</label>
	  <input type="text" name="credential_0" size="15" />
	</p>
	<p>
	  <label for="credential_1">Password:</label>
	  <input type="password" name="credential_1" size="15" />
	</p>
	<p>
%# These can be removed when it is known to be working.
	  <input type="radio" name="destination" value="<% $redirect_path %>" checked="checked" /> Continue what I was doing <br />
	  <input type="radio" name="destination" value="<% $main_page %>" /> Go to main page <br />
          <input type="submit" value="Continue" />
	</p>
      </form>
    </fieldset>	
  </div>
</div>

</div>

</div>
