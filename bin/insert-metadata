#
# Meta is a table containing information about the database
# to help in coding upper layers of the application
# This script inserts data in Meta table
#

use strict;
use DBIx::DBSchema; 

my ($DB_HOME, $DB_DATABASE, $DB_DBA) = @ARGV;

$DB_HOME ||= "/usr";
$DB_DATABASE ||= "netdot";
$DB_DBA ||= "root";
my $BINDIR = "$DB_HOME/bin";
my $TMP = "./.tmp";

my $SCHEMA_DIR = '../etc';
my $SCHEMA_FILE = "$SCHEMA_DIR/netdot.schema";

my $schema_href = do "$SCHEMA_FILE" or die $@ || $!;
my $schema = DBIx::DBSchema->pretty_read($schema_href);
my %tbtree;
my $inserttypes;

my @table_objs = map { $schema->table($_) } $schema->tables;

foreach my $table_obj (@table_objs){
    my @col_objs;
    map { push @col_objs, $table_obj->column($_) } $table_obj->columns;
    foreach my $col_obj (@col_objs){
	$tbtree{$table_obj->name}{$col_obj->name}{type} = $col_obj->type;
    }
}

foreach my $table (keys %tbtree){
    $inserttypes .= sprintf "UPDATE Meta SET columntypes = \'%s\' WHERE name = \'$table\';\n", 
       join ',', map { "$_:$tbtree{$table}{$_}{type}" } keys %{$tbtree{$table}} ; 
}

open (TMP, ">$TMP")
    or die "Can't open $TMP: $!\n";


print TMP <<END;

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('ArpCache', 
	  'tstamp,interface', 
	  'tstamp,interface', 
	  'tstamp,interface', 
	  'tstamp:Timestamp,interface:Interface',
	  '',
	  '', 
	  'entries:ArpCacheEntry:arpcache', 
	  '0', 
	  'Device ARP Cache');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('ArpCacheEntry', 
	  'ipaddr,physaddr', 
	  'ipaddr,physaddr,arpcache', 
	  'ipaddr,physaddr', 
	  'ipaddr:IP Address,physaddr:Physical Address,arpchache:ARP Cache',
	  '',
	  'ipaddr:Ipblock,physaddr:PhysAddr,arpcache:ArpCache', 
	  '', 
	  '0', 
	  'ARP Cache Entry');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Availability', 
	  'name', 
	  'name,info', 
	  'name',
	  'name:Time Period,info:Comments',
	  '',
	  '', 
	  'sites:Site:availability:{on_delete=>"set-null"},entities:Entity:availability:{on_delete=>"set-null"},email_notifications:Contact:notify_email:{on_delete=>"set-null"},page_notifications:Contact:notify_pager:{on_delete=>"set-null"},voice_notifications:Contact:notify_voice:{on_delete=>"set-null"},', 
	  '0',
	  'A Time Period'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('BackboneCable', 
	  'name', 
	  'name,type,owner,installdate,start_closet,end_closet,length,info', 
	  'name,start_closet,end_closet', 
	  'name:Cable ID,type:Cable Type,owner:Owned by,installdate:Installed on,start_closet:Origin Closet,end_closet:Destination Closet,length:Length (ft),info:Comments',
	  '',
	  'type:CableType,owner:Entity,start_closet:Closet,end_closet:Closet', 
	  'strands:CableStrand:cable', 
	  '0', 
	  'A Backbone cable with multiple strands'
	  );
INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('BackboneCable_history', 
	  'modified', 
	  'name,type,owner,installdate,start_closet,end_closet,length,infomodified,modifier', 
	  'modified,modifier,name,start_closet,end_closet', 
	  'name:Cable ID,type:Cable Type,owner:Owned by,installdate:Installed on,start_closet:Origin Closet,end_closet:Destination Closet,length:Length (ft),info:Commentsmodified:Modified on,modifier:Modified by',
	  '',
	  'type:CableType,owner:Entity,start_closet:Closet,end_closet:Closet', 
	  '', 
	  '0', 
	  ''
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('BinFile', 
	  'filename', 
	  'bindata,filename,filesize,filetype,info', 
	  'filename,filesize,filetype', 
	  'bindata:Binary Data,filename:File Name,filesize:File Size,filetype:File Type,info:Comments',
	  '',
	  '', 
	  'closets:Closet:picture,floormaps:Floor:map', 
	  '0', 
	  'A Binary File'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('CableStrand', 
	  'name', 
	  'name,cable,status,datetested,loss,direction,circuit_id,description,parent,info', 
	  'name,cable,direction,status',
	  'name:Strand ID,cable:Cable ID,status:Status,datetested:Date Tested,loss:Loss,direction:Direction (Tx/Rx),circuit_id:Circuit,description:Description,parent:Parent Strand,info:Comments',
	  '',
	  'cable:BackboneCable,status:StrandStatus,parent:CableStrand', 
	  '', 
	  '0', 
	  'A single cable strand/pair'
	  );
INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('CableStrand_history', 
	  'modified', 
	  'cable,name,status,loss,direction,circuit_id,description,parent,info,modified,modifier', 
	  'modified,modifier,cable,name,direction', 
	  'name:Strand ID,cable:Cable ID,status:Status,datetested:Date Tested,loss:Loss,direction:Direction (Tx/Rx),circuit_id:Circuit,description:Description,parent:Parent Strand,info:Commentsmodified:Modified on,Modifier:Modified by',
	  '',
	  'cable:BackboneCable,status:StrandStatus,parent:CableStrand', 
	  '', 
	  '0', 
	  ''
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('CableType', 
	  'name', 
	  'name,info', 
	  'name', 
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'backbonecables:BackboneCable:type:{on_delete=>"restrict"},horizontalcables:HorizontalCable:type:{on_delete=>"restrict"}', 
	  '0', 
	  'Types of Cables'
	  );
INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Circuit', 
	  'cid', 
	  'cid,connectionid,status,nearend,farend,type,speed,dlci,installdate,vendor,info', 
	  'cid,connectionid,nearend,farend,type,vendor,status', 
	  'cid:Circuit ID,connectionid:Part of Connection,status:Status,nearend:Near Interface,farend:Far Interface,type:Type,speed:Speed,dlci:DLCI,installdate:Installed on,vendor:Provider,info:Comments',
	  '',
	  'type:CircuitType,nearend:Interface,farend:Interface,connectionid:Connection,vendor:Entity,status:CircuitStatus', 
	  '', 
	  '0', 
	  'A WAN circuit provided by a third party'
	  );
INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Circuit_history', 
	  'modified', 
	  'cid,connectionid,status,nearend,farend,type,speed,dlci,installdate,vendor,info,modified,modifier', 
	  'modified,modifier,cid,connectionid,nearend,farend,type,vendor,status', 
	  'cid:Circuit ID,connectionid:Part of Connection,status:Status,nearend:Near Interface,farend:Far Interface,type:Type,speed:Speed,dlci:DLCI,installdate:Installed on,vendor:Provider,info:Comments,modified:Modified on,modifier:Modified by',
	  '',
	  'type:CircuitType,nearend:Interface,farend:Interface,connectionid:Connection,vendor:Entity,status:CircuitStatus', 
	  '', 
	  '0', 
	  ''
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('CircuitStatus', 
	  'name',  
	  'name,info', 
	  'name', 
	  'name:Status,info:Comments',
	  '',
	  '', 
	  'circuits:Circuit:status:{on_delete=>"restrict"}', 
	  '0', 
	  'Circuit status');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('CircuitType', 
	  'name', 
	  'name,info', 
	  'name', 
	  'name:Type,info:Comments',
	  '',
	  '', 
	  'circuits:Circuit:type:{on_delete=>"restrict"}', 
	  '0', 
	  'Types of WAN circuits');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Closet', 
	  'name', 
	  'name,number,site,floor,dimensions,racks,outlets,ru_avail,patch_panels,110_blocks,66_blocks,catv_taps,access_key_type,work_needed,picture,info', 
	  'name,number,site,floor', 
	  'name:ID,number:Number,site:Site,floor:Floor,dimensions:Dimensions ("),racks:Racks,outlets:Outlets,ru_avail:Rack Units Available,patch_panels:Patch Panels,110_blocks:110 Blocks,66_blocks:66 Blocks,catv_taps:CableTV Taps,access_key_type:Access Key Type,work_needed:Work Needed,picture:Picture,info:Comments',
	  '',
	  'site:Site,floor:Floor,picture:BinFile', 
	  '', 
	  '0', 
	  'A Communications Closet');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Connection', 
	  'name', 
	  'name,entity,nearend,farend,info', 
	  'name,entity,nearend,farend', 
	  'name:Name,entity:Entity,nearend:Origin (Site),farend:Destination (Site),info:Comments',
	  '',
	  'nearend:Site,farend:Site,entity:Entity', 
	  'circuits:Circuit:connectionid:{on_delete=>"set-null"}', 
	  '0', 
	  'Link between two sites.  A connection can consist of one or more circuits');
INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Connection_history', 
	  'modified', 
	  'name,entity,nearend,farend,info,modified,modifier', 
	  'modified,modifier,name,entity,nearend,farend', 
	  'name:Name,entity:Entity,nearend:Origin (Site),farend:Destination (Site),info:Comments,modified:Modified on,modifier:Modified by',
	  '',
	  'nearend:Site,farend:Site,entity:Entity', 
	  '', 
	  '0', 
	  '');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Contact', 
	  'person,contacttype', 
	  'person,contacttype,contactlist,notify_email,notify_pager,notify_voice,escalation_level,info', 
	  'person,contacttype,contactlist', 
	  'person:Person,contacttype:Type of Contact,contactlist:Contact Group,notify_email:Email Notifications,notify_pager:Pager Notifications,notify_voice:Voice Notifications,escalation_level:Escalation Level,info:Comments',
	  '',
	  'contactlist:ContactList,contacttype:ContactType,person:Person,notify_email:Availability,notify_pager:Availability,notify_voice:Availability', 
	  '', 
	  '0', 
	  'Contact Information');
INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Contact_history', 
	  'modified', 
	  'person,contacttype,contactlist,notify_email,notify_pager,notify_voice,,escalation_level,info,modified,modifier', 
	  'modified,modifier,contacttype,person', 
	  'person:Person,contacttype:Type of Contact,contactlist:Contact Group,notify_email:Email Notifications,notify_pager:Pager Notifications,notify_voice:Voice Notifications,escalation_level:Escalation Level,info:Comments,modified:Modified on,Modifier:Modified by',
	  '',
	  'contactlist:ContactList,contacttype:ContactType,person:Person,notify_email:Availability,notify_pager:Availability,notify_voice:Availability', 
	  '', 
	  '0', 
	  '');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('ContactList', 
	  'name', 
	  'name,info', 
	  'name,info', 
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'contacts:Contact:contactlist,entities:Entity:contactlist:{on_delete=>"set-null"},devices:Device:contactlist:{on_delete=>"set-null"},sites:Site:contactlist:{on_delete=>"set-null"},services:IpService:contactlist:{on_delete=>"set-null"},zones:Zone:contactlist:{on_delete=>"set-null"},interfaces:Interface:contactlist,resourcerecords:RR:contactlist:{on_delete=>"set-null"},outlets:HorizontalCable:contactlist:{on_delete=>"set-null"}', 
	  '0', 
	  'A list of contacts');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('ContactType', 
	  'name', 
	  'name,info', 
	  'name',
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'contacts:Contact:contacttype:{on_delete=>"restrict"}', 
	  '0', 
	  'Type of contact');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Device', 
	  'name', 
	  'name,aliases,type,sysdescription,physaddr,oobname,oobnumber,entity,contactlist,person,managed,community,serialnumber,productname,part_of,inventorynumber,maint_covered,canautoupdate,site,room,rack,dateinstalled,info', 
	  'name,type,productname', 
	  'name:Name,aliases:Aliases,type:Type,sysdescription:System Description,physaddr:Physical (MAC) Address,oobname:Out-of-Band Hostname,oobnumber:Out-of-Band Tel Number,entity:Belongs to (Entity),contactlist:Contact Group,person:User,managed:Managed?,community:SNMP Community,serialnumber:Serial Number,productname:Product Name,part_of:Part of Device,inventorynumber:Inventory Number,maint_covered:In Maintenance Contract?,canautoupdate:Auto Update?,site:Building,room:Room,rack:Rack,dateinstalled:Installed on,info:Comments',
	  '',
	  'name:RR,type:DeviceType,entity:Entity,contactlist:ContactList,person:Person,productname:Product,part_of:Device,site:Site,physaddr:PhysAddr', 
	  'interfaces:Interface:device,parts:Device:part_of', 
	  '0', 
	  'A network device');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Device_history', 
	  'modified', 
	  'name,aliases,type,sysdescription,physaddr,oobname,oobnumber,entity,contactlist,person,managed,community,serialnumber,productname,part_of,inventorynumber,maint_covered,canautoupdate,site,room,rack,dateinstalled,info,modified,modifier', 
	  'modified,modifier,name,type', 
	  'name:Name,aliases:Aliases,type:Type,sysdescription:System Description,physaddr:Physical (MAC) Address,oobname:Out-of-Band Hostname,oobnumber:Out-of-Band Tel Number,entity:Belongs to (Entity),contactlist:Contact Group,person:User,managed:Managed?,community:SNMP Community,serialnumber:Serial Number,productname:Product Name,part_of:Part of Device,inventorynumber:Inventory Number,maint_covered:In Maintenance Contract?,canautoupdate:Auto Update?site:Location,room:Room,rack:Rack,dateinstalled:Installed on,info:Comments,modified:Modified on,modifier:Modified by',
	  '',
	  'name:RR,type:DeviceType,entity:Entity,contactlist:ContactList,person:Person,productname:Product,part_of:Device,site:Site,physaddr:PhysAddr', 
	  '', 
	  '0', 
	  '');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DeviceType', 
	  'name', 
	  'name,info', 
	  'name',
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'devices:Device:type:{on_delete=>"restrict"}', 
	  '0', 
	  'Types of network devices');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DhcpAttr', 
	  'name,value', 
	  'name,value,scope', 
	  'name,value,scope',
	  'name:Name,value:Value,scope:Scope',
	  '',
	  'name:DhcpAttrName,scope:DhcpScope', 
	  'ipranges:IpRange:dhcp_attr', 
	  '0', 
	  'A DHCP Attribute or Parameter');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DhcpAttrName', 
	  'name', 
	  'name,code,format,info', 
	  'name',
	  'name:Name,code:Code,format:Format,info:Comments',
	  '',
	  '', 
	  'attributes:DhcpAttr:name:{on_delete=>"restrict"}', 
	  '0', 
	  'A DHCP Attributes Name');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DhcpScope', 
	  'service,type,name', 
	  'type,name,part_of,subnet,service,info', 
	  'service,type,name',
	  'name:Name,part_of:Belongs to,subnet:Subnet,service:DHCP Service,info:Comments',
	  '',
	  'type:DhcpScopeType,part_of:DhcpScope,subnet:Ipblock,service:IpService', 
	  'attributes:DhcpAttr:host', 
	  '0', 
	  'A DHCP Scope');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DhcpScopeType', 
	  'name', 
	  'name,info', 
	  'name,',
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'scopes:DhcpScope:type', 
	  '0', 
	  'A DHCP Scope Type');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Entity', 
	  'name', 
	  'name,aliases,type,availability,contactlist,acctnumber,maint_contract,autsys,bgppeerip,info', 
	  'name,type', 
	  'name:Name,aliases:Aliases,type:Type,availability:Availability,contactlist:Contact Group,acctnumber:Account Number,maint_contract:Maintenance Contract,autys:Autonomous System,bgppeerip:BGP Peer IP,info:Comments',
	  '',
	  'contactlist:ContactList,availability:Availability,type:EntityType', 
	  'connections:Connection:entity,sites:EntitySite:entity,products:Product:manufacturer,subnets:Ipblock:entity:{on_delete=>"set-null"},cables:BackboneCable:owner:{on_delete=>"set-null"},devices:Device:entity:{on_delete=>"set-null"},people:Person:entity', 
	  '0', 
	  'An organization related to the network in some way');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Entity_history', 
	  'modified',
	  'name,aliases,type,availability,contactlist,acctnumber,maint_contract,autsys,bgppeerip,info,modified,modifier', 
	  'modified,modifier,name,type', 
	  'name:Name,aliases:Aliases,type:Type,availability:Availability,contactlist:Contact Group,acctnumber:Account Number,maint_contract:Maintenance Contract,autsys:Autonomous System,bgppeerip:BGP Peer IP,info:Comments,modified:Modified on,modifier:Modified by',
	  '',
	  'contactlist:ContactList,availability:Availability,type:EntityType', 
	  '', 
	  '0', 
	  '');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('EntitySite', 
	  'entity,site', 
	  'entity,site', 
	  'entity,site', 
	  'entity:Entity,site:Site', 
	  '', 
	  '1', 'Entity to Site join table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('EntityType', 
	  'name', 
	  'name,info', 
	  'name', 
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'entities:Entity:type:{on_delete=>"restrict"}', 
	  '0', 
	  'Types of Entities');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Floor', 
	  'level', 
	  'level,map,site,info', 
	  'level,site', 
	  'level:Level,map:Map,site:Site,info:Comments',
	  '',
	  '', 
	  'entries:FWTableEntry:fwtable', 
	  '0', 
	  'Bridge Forwarding Table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('FWTable', 
	  'tstamp,deviceip', 
	  'tstamp,deviceip', 
	  'tstamp,deviceip', 
	  'tstamp:Timestamp,deviceip:Device IP',
	  '',
	  '', 
	  'entries:FWTableEntry:fwtable', 
	  '0', 
	  'Bridge Forwarding Table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('FWTableEntry', 
	  'interface,physaddr', 
	  'interface,physaddr,fwtable,leaf', 
	  'interface,physaddr', 
	  'interface:Interface,physaddr:Physical Address,fwtable: FW Table,leaf:Is Leaf?',
	  '',
	  'interface:Interface,physaddr:PhysAddr,fwtable:FWTable', 
	  '', 
	  '0', 
	  'Device Forwarding Table');


INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('HorizontalCable', 
	  'jackid', 
	  'jackid,type,datetested,testpassed,installdate,length,closet,room,account,contactlist,info', 
	  'jackid,closet,room', 
	  'jackid:Jack ID,type:Type,datetested:Date Tested,testpassed:Passed Test?,installdate:Date Installed,closet:Closet,room:Room,account:Account,contaclist:Contact List,info:Comments',
	  '',
	  'type:CableType,closet:Closet,contactlist:ContactList', 
	  'interfaces:Interface:jack:{on_delete=>"set-null"}', 
	  '0', 
	  'Horizontal Cable');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Interface', 
	  'number,name,device', 
	  'number,name,device,jack,description,type,speed,duplex,status,physaddr,managed,contactlist,info', 
	  'number,name,device,jack,description', 
	  'number:Number,name:Name,device:Device,jack:Jack,description:Description,type:Type,speed:Speed,duplex:Duplex,status:Status,physaddr:Physical (MAC) Address,info:Comments,managed:Managed?,contactlist:Contact List',
	  '',
	  'device:Device,jack:HorizontalCable,physaddr:PhysAddr', 
	  'ips:Ipblock:interface,parents:InterfaceDep:child,children:InterfaceDep:parent,nearcircuits:Circuit:nearend:{on_delete=>"set-null"},farcircuits:Circuit:farend:{on_delete=>"set-null"},fwtentries:FWTableEntry:interface,vlans:InterfaceVlan:interface', 
	  '0', 
	  'An interface associated with a device'
	  );
INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Interface_history', 
	  'modified', 
	  'number,name,device,jack,description,type,speed,duplex,status,physaddr,managed,contactlist,info,modified,modifier', 
	  'number,name,device,jack,description,modified,modifier',
	  'number:Number,name:Name,device:Device,jack:Jack,description:Description,type:Type,speed:Speed,duplex:Duplex,status:Status,physaddr:Physical (MAC) Address,info:Comments,managed:Managed?,contactlist:Contact List,modified:Modified on,modifier:Modified by',
	  '',
	  'device:Device,jack:HorizontalCable,physaddr:PhysAddr', 
	  '', 
	  '0', 
	  '');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('InterfaceDep', 'parent,child', 'parent,child', 'parent,child', 'parent:Interface,child:Interface', '', '1', 'Dependency relationship between two interfaces. Provides a basis for topology information');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description) 
    VALUES ('InterfaceVlan', 
	    'interface,vlan',
	    'interface,vlan', 
	    'interface,vlan', 
	    'interface:Interface,vlan:Vlan', 
	    '', 
	    '1', 
	    'Interface to VLAN join table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Ipblock', 
	  'address', 
	  'address,prefix,version,parent,interface,registered,allocated,delegated,entity,description,last_seen,physaddr', 
	  'address,prefix',
	  'address:Address,prefix:Prefix Length,version:Version(4/6),parent:Parent,interface:Interface,registered:Registered?,allocated:Allocated?,delegated:Delegated?,entity:Assigned to,description:Description,last_seen:Last Seen,physaddr:MAC Address',
	  '',
	  'interface:Interface,parent:Ipblock,entity:Entity,physaddr:PhysAddr', 
	  'services:IpService:ip,fwtables:FWTable:deviceip,arpentries:ArpCacheEntry:ipaddr,resourcerecords:RRIp:ip,children:Ipblock:parent:{on_delete=>"restrict"},dhcpentries:DhcpScope:subnet:{on_delete=>"restrict"},vlans:Vlan:subnet:{on_delete=>"restrict"},zones:SubnetZone:subnet', 
	  '0', 
	  'An IP (v4 or v6) Address');


INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('IpRange', 
	  'start_ip,end_ip', 
	  'start_ip,end_ip', 
	  'start_ip,end_ip', 
	  'start_ip:Ipblock,end_ip:Ipblock,dhcp_attr:DhcpAttr', 
	  '', 
 	  '0', 
	  'An IP range for DHCP dynamic assignments');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('IpService', 
	  'ip,service', 
	  'ip,service,managed,contactlist', 
	  'ip,service', 
	  'ip:Ipblock,service:Service,contactlist:ContactList', 
	  'dhcpconfigs:DhcpScope:service', 
 	  '0', 
	  'A relationship linking an Ip address with a running Internet service');


INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('Person', 
	    'lastname,firstname', 
	    'lastname,firstname,aliases,position,entity,location,email,office,cell,home,pager,emailpager,fax,info', 
	    'lastname,firstname,office,entity', 
	    'lastname:Last Name,firstname:First Name,aliases:Aliases,position:Position,entity:Employer,location:Location,email:Email,office:Work Phone,cell:Cell Phone,home:Home Phone,pager:Pager,emailpager:Email Pager,fax:Fax,info:Comments',
	    '',
	    'entity:Entity,location:Site', 
	    'roles:Contact:person,devices:Device:person:{on_delete=>"set-null"}', 
	    '0', 
	    'Information about an individual');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Person_history', 
	  'modified', 
	  'lastname,firstname,aliases,position,entity,location,email,office,cell,home,pager,emailpager,fax,info,modified,modifier', 
	  'modified,modifier,lastname,firstname,position,entity', 
	   'lastname:Last Name,firstname:First Name,aliases:Aliases,position:Position,entity:Employer,location:Location,email:Email,office:Work Phone,cell:Cell Phone,home:Home Phone,pager:Pager,emailpager:Email Pager,fax:Fax,info:Comments,modified:Modified on,modifier:Modified by',
	  'entity:Entity,location:Site',
	  '',
	  '', 
	  '0', 
	  '');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('PhysAddr', 
	    'address', 
	    'address,last_seen', 
	    'address,last_seen', 
	    'address:Address,last_seen:Last Seen',
	    '',
	    '', 
	    'interfaces:Interface:physaddr:{on_delete=>"set-null"},devices:Device:physaddr:{on_delete=>"set-null"},fwtableentries:FWTableEntry:physaddr,registeredips:Ipblock:physaddr,arpentries:ArpCache:physaddr', 
	    '0', 
	    'A physical or MAC address');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Product', 
	  'name', 
	  'name,description,sysobjectid,manufacturer,info', 
	  'name,description,manufacturer', 
	  'name:Name,description:Description,sysobjectid:System ID,manufacturer:Manufacturer,info:Comments',
	  '',
	  'manufacturer:Entity', 
	  'devices:Device:productname:{on_delete=>"restrict"}', 
	  '0', 
	  'Product Names');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Product_history', 
	  'modified', 
	  'name,description,manufacturer,info,modified,modifier', 
	  'modified,modifier,name,description,manufacturer', 
	  'name:Name,description:Description,manufacturer:Manufacturer,info:Comments,modified:Modified on,modifier:Modified by',
	  '',
	  'manufacturer:Entity', 
	  '', 
	  '0', 
	  '');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RR', 
	    'name',
	    'zone,origin,name,type,data,ttl,active,contactlist', 
	    'zone,origin,name,type', 
	    'zone:Zone,origin:Origin,name:Name,type:Type,data:Data,ttl:TTL,active:Active?,contactlist:ContactList', 
	    '',
	    'zone:Zone,type:RRType,contactlist:ContactList',
	    'ips:RRIp:rr', 
	    '0', 
	    'DNS Resource Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRType', 
	    'name',
	    'name,info', 
	    'name',
	    'name:Name,info:Comments', 
	    '',
	    '', 
	    'rrs:RR:type:{on_delete=>"restrict"},', 
	    '0', 
	    'Resource Record Type');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRIp', 
	    'rr,ip',
	    'rr,ip', 
	    'rr,ip',
	    'rr:Resource Record,ip:IP Address', 
	    '',
	    'rr:RR,ip:Ipblock', 
	    '', 
	    '1', 
	    'RR to IP join table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Service', 
	  'name', 
	  'name,info', 
	  'name', 
	  'name:Name,info:Comments', 
	  '',
	  '',
	  'Ips:IpService:service', 
	  '0', 
	  'An Internet service');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Site', 
	  'name', 
	  'name,number,aliases,street1,street2,pobox,city,state,zip,country,availability,contactlist,info', 
	  'name,number,street1,city', 
	  'name:Name,number:Site ID,aliases:Aliases,street1:Street (1),street2:Street (2),pobox:P.O. Box,city:City,state:State,zip:Zip/Postal Code,country:Country,availability:Availability,contactlist:Contact Group,info:Comments',
	  '',
	  'availability:Availability,contactlist:ContactList', 
	  'nearconnections:Connection:nearend,farconnections:Connection:farend,entities:EntitySite:site:{on_delete=>"set-null"},devices:Device:site:{on_delete=>"set-null"},people:Person:location:{on_delete=>"set-null"},horizontalcables:HorizontalCable:site', 
	  '0', 
	  'A Physical location');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Site_history', 
	  'modified', 
	  'name,number,aliases,street1,street2,pobox,city,state,zip,country,availability,contactlist,info,modified,modifier', 
	  'modified,modifier,name,number,street1', 
	  'name:Name,number:Site ID,aliases:Aliases,street1:Address Line 1,street2:Address Line 2,pobox:P.O. Box,city:City,state:State,zip:Zip/Postal Code,country:Country,availability:Availability,contactlist:Contact Group,info:Comments,modified:Modified on,modifier:Modified by',
	  '',
	  'availability:Availability,contactlist:ContactList', 
	  '', 
	  '0', 
	  '');


INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('StrandStatus', 'name',  'name', 'name', '', 'strands:CableStrand:status:{on_delete=>"restrict"}', '0', 'Cable strand/pair status');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('SubnetZone', 
	  'subnet,zone', 
	  'subnet,zone,', 
	  'subnet,zone', 
	  'subnet:Ipblock,zone:Zone', 
	  '', 
 	  '1', 
	  'IP Subnet to DNS Zone join table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Vlan', 
	  'vid', 
	  'vid,subnet,description,info', 
	  'vid',
	  'vid:VLAN ID,subnet:Subnet,description:Description,info:Comments',
	  '',
	  'subnet:Ipblock', 
	  'interfaces:InterfaceVlan:vlan', 
	  '0', 
	  'A Virtual LAN');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Zone', 
	  'mname', 
	  'mname,rname,serial,refresh,retry,expire,minimum,contactlist,active,reverse,masterserver,info', 
	  'mname,masterserver',
	  'mname:Domain Name,rname:Mail Box,serial:Serial,refresh:Refresh,retry:Retry,expire:Expire,minimum:Minimum,contactlist:Contact List,active:Active?,reverse:Reverse?,masterserver:Master Server,info:Comments',
	  '',
	  'contactlist:ContactList,masterserver:IpService', 
	  'records:RR:zone:{on_delete=>"restrict"},subnets:SubnetZone:zone', 
	  '0', 
	  'A DNS Zone');


$inserttypes

END
close(TMP);

print "Enter the password for the database user $DB_DBA.\n";
system ("$BINDIR/mysql --user=$DB_DBA $DB_DATABASE -p < $TMP");

system ("rm -f $TMP");
