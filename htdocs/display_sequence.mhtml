<%doc>
Display sequences for the given strands.

TODO: revisit this code at some point and move appropriate sections
      to CablePlantManager, tweak for performance, etc.

Arguments:
    - strands: an array of CableStrands to display sequences for
    - table_view: if set, output is in a table format.
</%doc>

<%perl>
my %used = ();
my %sequences = ();
</%perl>

% if ($table_view) {
<table border="0" width="95%" align="center" class="tablebackground">
    <tr>
    <td valign="top" width="50%" align="center">
    <table border="0" width="100%"  class="formtablebg" cellpadding="0" cellspacing="2">
    <tr class="formtabletitle">
     <td colspan="2">
      <table width="100%" border="0">
       <tr>
         <td width="10%" align="left">&nbsp;</td>
         <th width="80%" align="center">Cable Strand Sequence(s)</th>
       </tr>
      </table>
     <td>
   </tr>
   <tr>
     <td>
    <table border="0" width="90%">
%   my $j = 0;
%   my $i = 0;
%   my %found = ();
%   foreach my $st (@{$strands}) {
%       next if (exists($found{$st}));
%       $j = ($j + 1) % 2;
%       ++$i;
%       my @links = ();
%       my @ids = ();
%       foreach my $row (@{$cable_manager->getsequence($st)}) {
%           $found{@$row[0]} = 1;
%           push(@links, sprintf("<A HREF=\"cable_strand.html?id=%d\">%s</A>", @$row[0], @$row[1]));
%           push(@ids, @$row[0]);
%       }
        <tr align="left" class="<% $cssitem{$j} %>">
            <td align="left">
                <input type="hidden" name="__sequence_<% $i %>" value="<% join(",", @ids) %>"> 
                [unassign] <input type="checkbox" name="__unassign_<% $i %>"> <% join("  -----  ", @links) %>
            </td>
        </tr>
%   }
</table>
</td>
</tr>
</table>

% } else {
<%perl>
    my @links = ();
    foreach my $st (@{$strands}) {
        foreach my $row (@{$cable_manager->getsequence($st)}) {
            push(@links, sprintf("<A HREF=\"cable_strand.html?id=%d\">%s</A>", @$row[0], @$row[1]));
        }
    }

    printf("%s\n", join(" ----- ", @links));
</%perl>
% }

<%args>
$strands => undef;
$table_view => undef;
</%args>

<%init>
my %cssitem = (0=>"formtablec1", 1=>"formtablec2");
my $cable_manager = Netdot::CablePlantManager->new();
</%init>
