<%doc>

 Network Management Functions

</%doc>

<%args>
$user
</%args>

<%attr>
title   => 'Management' 
section => 'Management'
</%attr>

<%init>
my $DEBUG = 0;
print '%ARGS is  <pre>', Dumper(%ARGS), '</pre><br>' if $DEBUG;

my %caller_args = $m->caller_args(-1);

if (exists($caller_args{page})){
    $user->setAttribute($r, "MANAGEMENT_PAGE", $caller_args{page});
}
my $page = $user->getAttribute("MANAGEMENT_PAGE");

</%init>
%
<div id="sectiontools">
%
% if ($page eq "DEVICE" || $page eq "") {
%
    <p>
    <fieldset>
        <legend>Find Devices</legend>
        <p>
        <form action="device.html" method="POST">
            <p>
            <label for="search">Name:</label>
            <input type="text" name="search" class="txt" value=""> 
            <input name="submit" value="search" class="btn" type="submit">
            </p>
        </form>
        <form action="ip-ws.html" method="POST">
            <p>
            <label for="search">IP:</label>
            <input type="text" name="search" class="txt" value=""> 
            <input name="submit" value="search" class="btn" type="submit">
            <input type="hidden" name="_action" value="SEARCH">
            </p>
        </form> 
        <form action="mac-ws.html" method="POST">
            <p>
            <label for="search">MAC:</label>
            <input type="text" name="search" class="txt" value=""> 
            <input name="submit" value="search" class="btn" type="submit">
            </p>
        </form>
    </fieldset>
    </p>
    <p>
    <fieldset>

        <legend>Discover/Update a Device</legend>
        <form action="updatedevice.html" method="POST">
            <p>
            <label for="host">Name:</label>
            <input type="text" name="host" class="txt" value="">
            </p>
            <p>
            <label for="comstr">Community:</label>
            <input type="text" name="comstr" class="txt" value="<% $ui->{config}->{'DEFAULT_SNMPCOMMUNITY'} %>">
            <input type="hidden" name="action" value="discover">
            </p>
            <p>
            <input type="submit" name="submit" class="btn" value="discover">
            </p>
        </form>
    </fieldset>
    </p>
    <p>
    <fieldset>
        <legend>Manually Add a Device</legend>
	<form action="device.html" method="POST">
            <p>
            <label for="newhost">Name:</label>
            <input type="text" name="newhost" class="txt" value="">
            </p>
            <p>
            <label for="newip">IP:</label>
            <input type="text" name="newip" class="txt" value="">
            <input type="hidden" name="deviceadd" value="add">
            </p>
            <p>
            <input type="submit" name="submit" class="btn" value="add">
            </p>
        </form>
    </fieldset>
    </p>


% } elsif ($page eq "ADDRESS") {

<tr class="rowtitle0" >
    <td>
    <table border="0" cellpadding="4" cellspacing="0" width="100%" class="formtablebg">
       <tr>
          <td colspan="2" align="center">
              <form action="ip-ws.html" method="POST">
              <select name="id">
	          <option value="0" SELECTED> -- Select Root -- </option>
%	      my @rbs = $ipm->getrootblocks;
%             if (scalar @rbs){
%               foreach my $r ( @rbs ){
                  <option value="<% $r->id %>"><% $r->address . "/" . $r->prefix %></option>
%               }
%             }else{
                <option value="0"> - </option>                 
%             }
              </select>
              <input name="submit" value="Go" type="submit">
              <input type="hidden" name="_action" value="VIEW">
              </form>
          </td>
      </tr>
          <td>
              <form action="ip-ws.html" method="POST">
              Find Block (IP[/prefix])<input type="text" name="search" size="20" value=""> 
              <input name="submit" value="Find" type="submit">
              <input type="hidden" name="_action" value="SEARCH">
              </form>
          </td>
          <td>
              <form action="ip-ws.html" method="POST">
              Allocate New Block (IP/prefix)<input type="text" name="allocate" size="20" value=""> 
              <input name="submit" value="Allocate" type="submit">
              <input type="hidden" name="_action" value="ALLOCATE">
              </form>
          </td>
       <tr>
      </tr>
    </table>
    </td>
</tr>

</div>
%}
% if ( $m->fetch_next ){
%  $m->call_next;
% }
