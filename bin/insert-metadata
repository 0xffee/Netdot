#
# Meta is a table containing information about the database
# to help in coding upper layers of the application
# This script inserts data in Meta table
#

use strict;
use DBIx::DBSchema; 

my ($DB_HOME, $DB_DATABASE, $DB_DBA) = @ARGV;

$DB_HOME     ||= "/usr";
$DB_DATABASE ||= "netdot";
$DB_DBA      ||= "root";

my $BINDIR     = "$DB_HOME/bin";
my $TMP        = "./.tmp";

my $SCHEMA_DIR  = '../etc';
my $SCHEMA_FILE = "$SCHEMA_DIR/netdot.schema";

my $schema_href = do "$SCHEMA_FILE" or die $@ || $!;
my $schema = DBIx::DBSchema->pretty_read($schema_href);
my %tbtree;
my $inserttypes;

my @table_objs = map { $schema->table($_) } $schema->tables;

foreach my $table_obj (@table_objs){
    my @col_objs;
    map { push @col_objs, $table_obj->column($_) } $table_obj->columns;
    foreach my $col_obj (@col_objs){
	$tbtree{$table_obj->name}{$col_obj->name}{type} = $col_obj->type;
    }
}

foreach my $table (keys %tbtree){
    next if ($table =~ /_history/);
    $inserttypes .= sprintf "UPDATE Meta SET columntypes = \'%s\' WHERE name = \'$table\';\n", 
    join ',', map { "$_:$tbtree{$table}{$_}{type}" } keys %{$tbtree{$table}} ; 
}

open (TMP, ">$TMP")
    or die "Can't open $TMP: $!\n";


print TMP <<END;

DELETE FROM Meta;

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('ArpCache', 
	  'tstamp,interface', 
	  'tstamp,interface', 
	  'tstamp,interface', 
	  'tstamp:Timestamp,interface:Interface',
	  '',
	  'interface:Interface', 
	  'entries:ArpCacheEntry:arpcache', 
	  '0', 
	  'Device ARP Cache');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('ArpCacheEntry', 
	  'ipaddr,physaddr', 
	  'ipaddr,physaddr,arpcache', 
	  'ipaddr,physaddr,arpcache', 
	  'ipaddr:IP Address,physaddr:Physical Address,arpchache:ARP Cache',
	  '',
	  'ipaddr:Ipblock,physaddr:PhysAddr,arpcache:ArpCache', 
	  '', 
	  '0', 
	  'ARP Cache Entry');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Availability', 
	  'name', 
	  'name,info', 
	  'name',
	  'name:Time Period,info:Comments',
	  '',
	  '', 
	  'sites:Site:availability:{on_delete=>"set-null"},entities:Entity:availability:{on_delete=>"set-null"},email_notifications:Contact:notify_email:{on_delete=>"set-null"},page_notifications:Contact:notify_pager:{on_delete=>"set-null"},voice_notifications:Contact:notify_voice:{on_delete=>"set-null"},', 
	  '0',
	  'A Time Period'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('BackboneCable', 
	  'name', 
	  'name,type,owner,installdate,start_closet,end_closet,length,info', 
	  'name,start_closet,end_closet', 
	  'name:Cable ID,type:Cable Type,owner:Owned by,installdate:Installed on,start_closet:Origin Closet,end_closet:Destination Closet,length:Length (ft),info:Comments',
	  '',
	  'type:CableType,owner:Entity,start_closet:Closet,end_closet:Closet', 
	  'strands:CableStrand:cable', 
	  '0', 
	  'A Backbone cable with multiple strands'
	  );
INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('BGPPeering', 
	  'device,entity', 
	  'device,entity,bgppeerid,bgppeeraddr,monitored,monitorstatus',
	  'device,entity,bgppeeraddr', 
	  'device:Device,entity:Entity,monitor:Monitored?,monitorstatus:Monitored Status',
	  '', 
	  'device:Device,entity:Entity,monitorstatus:MonitorStatus', 
	  '',
	  '0', 
	  'A BGP Peering'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('BinFile', 
	  'filename', 
	  'bindata,filename,filesize,filetype,info', 
	  'filename,filesize,filetype', 
	  'bindata:Binary Data,filename:File Name,filesize:File Size,filetype:File Type,info:Comments',
	  '',
	  '', 
	  '',
	  '0', 
	  'A Binary File'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('CableStrand', 
	  'name', 
	  'name,number,cable,status,datetested,loss,direction,fiber_type,circuit_id,description,info', 
	  'name,cable,direction,status',
	  'name:Strand ID,number:Number,cable:Cable ID,status:Status,datetested:Date Tested,loss:Loss,direction:Direction (Tx/Rx),circuit_id:Circuit,description:Description,info:Comments',
	  '',
	  'cable:BackboneCable,fiber_type:FiberType,status:StrandStatus,circuit_id:Circuit', 
	  'splices:Splice:strand1',
	  '0', 
	  'A single cable strand/pair'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('CableType', 
	  'name', 
	  'name,info', 
	  'name', 
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'backbonecables:BackboneCable:type:{on_delete=>"restrict"},horizontalcables:HorizontalCable:type:{on_delete=>"restrict"}', 
	  '0', 
	  'Types of Cables'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('FiberType',
      'name',
      'name,info',
      'name',
      'name:Name,info:Comments',
      '',
      '',
      'strands:CableStrand:fiber_type',
      '0',
      'Types of Fiber'
      );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Circuit', 
	  'cid', 
	  'cid,connectionid,status,nearend,farend,type,speed,dlci,installdate,vendor,info', 
	  'cid,connectionid,nearend,farend,type,vendor,status', 
	  'cid:Circuit ID,connectionid:Part of Connection,status:Status,nearend:Near Interface,farend:Far Interface,type:Type,speed:Speed,dlci:DLCI,installdate:Installed on,vendor:Provider,info:Comments',
	  '',
	  'type:CircuitType,nearend:Interface,farend:Interface,connectionid:Connection,vendor:Entity,status:CircuitStatus', 
	  'strands:CableStrand:circuit_id', 
	  '0', 
	  'A WAN circuit provided by a third party'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('CircuitStatus', 
	  'name',  
	  'name,info', 
	  'name', 
	  'name:Status,info:Comments',
	  '',
	  '', 
	  'circuits:Circuit:status:{on_delete=>"restrict"}', 
	  '0', 
	  'Circuit status');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('CircuitType', 
	  'name', 
	  'name,info', 
	  'name', 
	  'name:Type,info:Comments',
	  '',
	  '', 
	  'circuits:Circuit:type:{on_delete=>"restrict"}', 
	  '0', 
	  'Types of WAN circuits');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Closet', 
	  'name,site', 
	  'name,number,site,floor,dimensions,racks,outlets,ru_avail,patch_panels,110_blocks,66_blocks,catv_taps,access_key_type,work_needed,shared_with,hvac_type,ground_buss,asbestos_tiles,rack_type,pair_count,converted_patch_panels,info', 
	  'name,number,site,floor', 
	  'name:ID,number:Number,site:Site,floor:Floor,dimensions:Dimensions ("),racks:Racks,outlets:Outlets,ru_avail:Rack Units Available,patch_panels:Patch Panels,110_blocks:110 Blocks,66_blocks:66 Blocks,catv_taps:CableTV Taps,access_key_type:Access Key Type,work_needed:Work Needed,shared_with:Shared With,hvac_type:HVAC Type,ground_buss:Ground Buss,asbestos_tiles:Asbestos Tiles,rack_type:Rack Type,pair_count:Pair Count,converted_patch_panels:Converted Patch Panels,info:Comments',
	  '',
	  'site:Site,floor:Floor', 
	  'horizontalcables:HorizontalCable:closet,backbones_start:BackboneCable:start_closet,backbones_end:BackboneCable:end_closet,pictures:ClosetPicture:closet', 
	  '0', 
	  'A Communications Closet');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('ClosetPicture', 
	  'closet,binfile', 
	  'closet,binfile', 
	  'closet,binfile', 
	  'closet:Closet,binfile:Binary File',
	  '',
	  'closet:Closet,binfile:BinFile', 
	  '', 
	  '1', 
	  'Closet Pictures');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Connection', 
	  'name', 
	  'name,entity,nearend,farend,info', 
	  'name,entity,nearend,farend', 
	  'name:Name,entity:Entity,nearend:Origin (Site),farend:Destination (Site),info:Comments',
	  '',
	  'nearend:Site,farend:Site,entity:Entity', 
	  'circuits:Circuit:connectionid', 
	  '0', 
	  'Link between two sites.  A connection can consist of one or more circuits');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('Contact', 
	  'person,contacttype', 
	  'person,contacttype,contactlist,notify_email,notify_pager,notify_voice,escalation_level,info', 
	  'person,contacttype,contactlist', 
	  'person:Person,contacttype:Type of Contact,contactlist:Contact Group,notify_email:Email Notifications,notify_pager:Pager Notifications,notify_voice:Voice Notifications,escalation_level:Escalation Level,info:Comments',
	  '',
	  'contactlist:ContactList,contacttype:ContactType,person:Person,notify_email:Availability,notify_pager:Availability,notify_voice:Availability', 
	  '', 
	  '0', 
	  'Contact Information');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('ContactList', 
	  'name', 
	  'name,info', 
	  'name,info', 
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'contacts:Contact:contactlist,entities:Entity:contactlist:{on_delete=>"set-null"},devices:Device:contactlist:{on_delete=>"set-null"},sites:Site:contactlist:{on_delete=>"set-null"},services:IpService:contactlist:{on_delete=>"set-null"},zones:Zone:contactlist:{on_delete=>"set-null"},interfaces:Interface:contactlist,resourcerecords:RR:contactlist:{on_delete=>"set-null"},outlets:HorizontalCable:contactlist:{on_delete=>"set-null"}', 
	  '0', 
	  'A list of contacts');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('ContactType', 
	  'name', 
	  'name,info', 
	  'name',
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'contacts:Contact:contacttype:{on_delete=>"restrict"}', 
	  '0', 
	  'Type of contact');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Device', 
	  'name', 
	  'name,aliases,sysdescription,physaddr,oobname,oobnumber,entity,contactlist,contactlist2,person,monitored,monitorstatus,snmp_managed,customer_managed,natted,community,serialnumber,productname,part_of,inventorynumber,maint_covered,canautoupdate,site,room,closet,rack,lastupdated,dateinstalled,info',
	  'name,productname',
	  'name:Name,aliases:Aliases,sysdescription:System Description,physaddr:Physical (MAC) Address,oobname:Out-of-Band Hostname,oobnumber:Out-of-Band Tel Number,entity:Belongs to (Entity),contactlist:Contacts,contactlist2:Secondary Contacts,person:User,monitored:Monitored?,monitorstatus:Monitored Status,snmp_managed:SNMP Managed?,customer_managed:Managed by Customer?,natted:NATted?,community:SNMP Community,serialnumber:Serial Number,productname:Product Name,part_of:Part of Device,inventorynumber:Inventory Number,maint_covered:In Maintenance Contract?,canautoupdate:Auto Update?,site:Building,room:Room,closet:Closet,rack:Rack,lastupdated:Last Updated,dateinstalled:First Discovered,info:Comments',
	  '',
	  'name:RR,entity:Entity,contactlist:ContactList,contactlist2:ContactList,person:Person,productname:Product,part_of:Device,site:Site,room:Room,closet:Closet,physaddr:PhysAddr,monitorstatus:MonitorStatus', 
	  'interfaces:Interface:device,parts:Device:part_of,bgppeers:BGPPeering:device', 
	  '0', 
	  'A network device');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DhcpAttr', 
	  'name,value', 
	  'name,value,scope', 
	  'name,value,scope',
	  'name:Name,value:Value,scope:Scope',
	  '',
	  'name:DhcpAttrName,scope:DhcpScope', 
	  '', 
	  '0', 
	  'A DHCP Attribute or Parameter');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DhcpAttrName', 
	  'name', 
	  'name,code,format,info', 
	  'name',
	  'name:Name,code:Code,format:Format,info:Comments',
	  '',
	  '', 
	  'attributes:DhcpAttr:name:{on_delete=>"restrict"}', 
	  '0', 
	  'A DHCP Attributes Name');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DhcpScope', 
	  'service,type,name', 
	  'type,name,part_of,ipblock,service,info', 
	  'service,type,name',
	  'name:Name,part_of:Belongs to,ipblock:IP Block,service:DHCP Service,info:Comments',
	  '',
	  'type:DhcpScopeType,part_of:DhcpScope,ipblock:Ipblock,service:IpService', 
	  'attributes:DhcpAttr:host', 
	  '0', 
	  'A DHCP Scope');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('DhcpScopeType', 
	  'name', 
	  'name,info', 
	  'name,',
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'scopes:DhcpScope:type', 
	  '0', 
	  'A DHCP Scope Type');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Entity', 
	  'name', 
	  'name,aliases,type,availability,contactlist,acctnumber,maint_contract,asname,asnumber,oid,info', 
	  'name,type', 
	  'name:Name,aliases:Aliases,type:Type,availability:Availability,contactlist:Contact Group,acctnumber:Account Number,maint_contract:Maintenance Contract,asname:AS Name,asnumber:AS Number,oid:Enterprise OID,info:Comments',
	  '',
	  'contactlist:ContactList,availability:Availability,type:EntityType', 
	  'connections:Connection:entity,sites:EntitySite:entity,products:Product:manufacturer,subnets:Ipblock:entity:{on_delete=>"set-null"},cables:BackboneCable:owner:{on_delete=>"set-null"},devices:Device:entity:{on_delete=>"set-null"},people:Person:entity,bgppeers:BGPPeering:entity', 
	  '0', 
	  'An organization related to the network in some way');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('EntitySite', 
	  'entity,site', 
	  'entity,site', 
	  'entity,site', 
	  'entity:Entity,site:Site', 
	  '', 
	  '1', 'Entity to Site join table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('EntityType', 
	  'name', 
	  'name,info', 
	  'name', 
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'entities:Entity:type:{on_delete=>"restrict"}', 
	  '0', 
	  'Types of Entities');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Floor', 
	  'level,site', 
	  'level,site,info', 
	  'level,site', 
	  'level:Level,site:Site,info:Comments',
	  '',
	  'site:Site',
	  'closets:Closet:floor,rooms:Room:floor,plans:FloorPlan:floor', 
	  '0', 
	  'Floor Table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
  VALUES ('FloorPlan', 
	  'floor,binfile', 
	  'floor,binfile', 
	  'floor,binfile', 
	  'floor:Floor,binfile:Binary File',
	  '',
	  'floor:Floor,binfile:BinFile', 
	  '', 
	  '1', 
	  'Floor Plans');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('FWTable', 
	  'tstamp,deviceip', 
	  'tstamp,deviceip', 
	  'tstamp,deviceip', 
	  'tstamp:Timestamp,deviceip:Device IP',
	  '',
	  '', 
	  'entries:FWTableEntry:fwtable', 
	  '0', 
	  'Bridge Forwarding Table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('FWTableEntry', 
	  'interface,physaddr', 
	  'interface,physaddr,fwtable,leaf', 
	  'interface,physaddr', 
	  'interface:Interface,physaddr:Physical Address,fwtable: FW Table,leaf:Is Leaf?',
	  '',
	  'interface:Interface,physaddr:PhysAddr,fwtable:FWTable', 
	  '', 
	  '0', 
	  'Device Forwarding Table');


INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('HorizontalCable', 
	  'jackid', 
	  'jackid,faceplateid,type,datetested,testpassed,installdate,length,closet,room,account,contactlist,info', 
	  'jackid,closet,room', 
	  'jackid:Jack ID,faceplateid:Faceplate ID,type:Type,datetested:Date Tested,testpassed:Passed Test?,installdate:Date Installed,length:Length,closet:Closet,room:Room,account:Account,contactlist:Contact List,info:Comments',
	  '',
	  'type:CableType,closet:Closet,contactlist:ContactList,room:Room', 
	  'interfaces:Interface:jack:{on_delete=>"set-null"}', 
	  '0', 
	  'Horizontal Cable');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Interface', 
	  'number,name,device',
	  'number,name,device,jack,jack_char,room_char,description,type,speed,admin_duplex,oper_duplex,admin_status,oper_status,monitored,monitorstatus,snmp_managed,physaddr,contactlist,info',
	  'number,name,device,jack,description', 
	  'number:Number,name:Name,device:Device,jack:Jack,jack_char:Jack(char),room_char:Room(char),description:Description,type:Type,speed:Speed,admin_duplex:Admin Duplex,oper_duplex:Oper Duplex,admin_status:Admin Status,oper_status:Oper Status,monitored:Monitored?,monitorstatus:Monitored Status,snmp_managed:SNMP-Managed?,physaddr:Physical (MAC) Address,info:Comments,contactlist:Contact List',
	  '',
	  'device:Device,jack:HorizontalCable,physaddr:PhysAddr,contactlist:ContactList,monitorstatus:MonitorStatus', 
	  'ips:Ipblock:interface,parents:InterfaceDep:child,children:InterfaceDep:parent,nearcircuits:Circuit:nearend:{on_delete=>"set-null"},farcircuits:Circuit:farend:{on_delete=>"set-null"},fwtentries:FWTableEntry:interface,vlans:InterfaceVlan:interface', 
	  '0', 
	  'An interface associated with a device'
	  );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('InterfaceDep', 'parent,child', 'parent,child', 'parent,child', 'parent:Interface,child:Interface', '', '1', 'Dependency relationship between two interfaces. Provides a basis for topology information');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description) 
    VALUES ('InterfaceVlan', 
	    'interface,vlan',
	    'interface,vlan', 
	    'interface,vlan', 
	    'interface:Interface,vlan:Vlan', 
	    '', 
	    '1', 
	    'Interface to VLAN join table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Ipblock', 
	  'address,prefix', 
	  'address,prefix,version,parent,interface,status,entity,description,first_seen,last_seen,dhcp_enabled,dns_delegated,physaddr,info', 
	  'address,prefix,status,entity',
	  'address:Address,prefix:Prefix Length,version:Version(4/6),parent:Parent,interface:Interface,status:Status,entity:Used by,description:Description,first_seen:First Seen,last_seen:Last Seen,dhcp_enabled:Enable DHCP?,dns_delegated:Delegate DNS?,physaddr:MAC Address,info:Info',
	  '',
	  'interface:Interface,parent:Ipblock,status:IpblockStatus,entity:Entity,physaddr:PhysAddr',
	  'services:IpService:ip,fwtables:FWTable:deviceip,arpentries:ArpCacheEntry:ipaddr,arecords:RRADDR:ipblock,ptrrecords:RRPTR:ipblock,children:Ipblock:parent:{on_delete=>"set-null"},dhcpentries:DhcpScope:ipblock:{on_delete=>"restrict"},vlans:Vlan:subnet:{on_delete=>"restrict"},zones:SubnetZone:subnet', 
	  '0', 
	  'An IP (v4 or v6) Address');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('IpblockStatus', 'name',  'name', 'name', '', 'ipblocks:Ipblock:status:{on_delete=>"restrict"}', '0', 'IP block status');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('IpService', 
	  'ip,service', 
	  'ip,service,monitored,monitorstatus,contactlist', 
	  'ip,service', 
	  'ip:Ipblock,service:Service,contactlist:ContactList,monitorstatus:MonitorStatus', 
	  'dhcpconfigs:DhcpScope:service', 
 	  '0', 
	  'A relationship linking an Ip address with a running Internet service');


INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('MonitorStatus',
            'name',
            'name,info',
            'name',
            'name:Status,info:Comments',
            '',
            '',
            'bgppeers:BGPPeering:monitorstatus:{cascade=>"Fail"},devices:Device:monitorstatus:{cascade=>"Fail"},ipservices:IpService:monitorstatus:{cascade=>"Fail"}',
            '0',
            'Status information for what is monitored' );

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('Person', 
	    'lastname,firstname', 
	    'lastname,firstname,aliases,position,entity,location,email,office,cell,home,pager,emailpager,fax,info', 
	    'lastname,firstname,office,entity', 
	    'lastname:Last Name,firstname:First Name,aliases:Aliases,position:Position,entity:Employer,location:Location,email:Email,office:Work Phone,cell:Cell Phone,home:Home Phone,pager:Pager,emailpager:Email Pager,fax:Fax,info:Comments',
	    '',
	    'entity:Entity,location:Site', 
	    'roles:Contact:person,devices:Device:person:{on_delete=>"set-null"}', 
	    '0', 
	    'Information about an individual');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('PhysAddr', 
	    'address', 
	    'address,static,first_seen,last_seen', 
	    'address,static,first_seen,last_seen', 
	    'address:Address,static:Static?,first_seen:First Seen,last_seen:Last Seen',
	    '',
	    '', 
	    'interfaces:Interface:physaddr:{on_delete=>"set-null"},devices:Device:physaddr:{on_delete=>"set-null"},fwtableentries:FWTableEntry:physaddr,registeredips:Ipblock:physaddr,arpentries:ArpCacheEntry:physaddr', 
	    '0', 
	    'A physical or MAC address');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Product', 
	  'name', 
	  'name,type,description,sysobjectid,manufacturer,info', 
	  'name,type,description,manufacturer', 
	  'name:Name,type:Type,description:Description,sysobjectid:System ID,manufacturer:Manufacturer,info:Comments',
	  '',
	  'type:ProductType,manufacturer:Entity', 
	  'devices:Device:productname:{on_delete=>"restrict"}', 
	  '0', 
	  'Product Names');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('ProductType', 
	  'name', 
	  'name,info', 
	  'name',
	  'name:Name,info:Comments',
	  '',
	  '', 
	  'products:Product:type:{on_delete=>"restrict"}', 
	  '0', 
	  'Types of network devices');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Room',
      'name',
      'name,floor',
      'name,floor',
      'name:Name,floor:Floor',
      '',
      'floor:Floor',
      'jacks:HorizontalCable:room',
      '0',
      'Room');
      

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RR', 
	    'name',
	    'name,zone,origin,active,auto_update,contactlist', 
	    'name,zone,origin', 
	    'zone:Zone,origin:Origin,name:Name,active:Active?,auto_update:Auto Update?:contactlist:ContactList', 
	    '',
	    'zone:Zone,contactlist:ContactList',
	    'arecords:RRADDR:rr,aliases:RRCNAME:cname,hinforecords:RRHINFO:rr,mxrecords:RRMX:rr,nsrecords:RRNS:rr,ptrrecords:RRPTR:rr,srvrecords:RRSRV:rr,txtrecords:RRTXT:rr,exchanges:RRMX:exchange,domains:RRNS:nsdname,devices:Device:name:{on_delete=>"restrict"}', 
	    '0', 
	    'DNS Resource Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRADDR', 
	    'ipblock,rr',
	    'ipblock,rr,ttl', 
	    'ipblock,rr', 
	    'rr:Resource Record,ipblock:Ipblock,ttl:TTL', 
	    '',
	    'rr:RR,ipblock:Ipblock',
	    '', 
	    '0', 
	    'DNS A or AAAA Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRCNAME', 
	    'alias,cname',
	    'alias,cname,ttl', 
	    'alias,cname', 
	    'alias:Alias,cname:CNAME,ttl:TTL', 
	    '',
	    'cname:RR',
	    '', 
	    '0', 
	    'DNS CNAME Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRHINFO', 
	    'cpu,os,rr',
	    'cpu,os,rr,ttl', 
	    'cpu,os,rr', 
	    'rr:Resource Record,cpu:CPU,os:OS,ttl:TTL', 
	    '',
	    'rr:RR',
	    '', 
	    '0', 
	    'DNS HINFO Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRMX', 
	    'preference,exchange,rr',
	    'preference,exchange,rr,ttl', 
	    'preference,exchange,rr', 
	    'rr:Resource Record,preference:Preference,exchange:Exchange,ttl:TTL', 
	    '',
	    'rr:RR,exchange:RR',
	    '', 
	    '0', 
	    'DNS MX Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRNS', 
	    'nsdname,rr',
	    'nsdname,rr,ttl', 
	    'nsdname,rr', 
	    'rr:Resource Record,nsdname:Name Server,ttl:TTL', 
	    '',
	    'rr:RR,nsdname:RR',
	    '', 
	    '0', 
	    'DNS NS Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRPTR', 
	    'ipblock,rr',
	    'ipblock,rr,,ttl', 
	    'ipblock,rr', 
	    'rr:Resource Record,ipblock:IP,ttl:TTL', 
	    '',
	    'rr:RR,ipblock:Ipblock',
	    '', 
	    '0', 
	    'DNS PTR Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRSRV', 
	    'target,rr',
	    'target,rr,ttl,priority,weight,port,target', 
	    'target,rr', 
	    'rr:Resource Record,ttl:TTL,priority:Priority,weight:Weight,port:Port,target:Target', 
	    '',
	    'rr:RR,target:RR',
	    '', 
	    '0', 
	    'DNS SRV Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRTXT', 
	    'txt,rr',
	    'txt,rr,ttl', 
	    'txt,rr', 
	    'rr:Resource Record,txt:Text,ttl:TTL', 
	    '',
	    'rr:RR',
	    '', 
	    '0', 
	    'DNS TXT Record');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description) 
    VALUES ('RRType', 
	    'name',
	    'name,tablename', 
	    'name,tablename',
	    'name:Name,tablename:Table', 
	    '',
	    '', 
	    '', 
	    '0', 
	    'Resource Record Types and their tables');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Service', 
	  'name', 
	  'name,info', 
	  'name', 
	  'name:Name,info:Comments', 
	  '',
	  '',
	  'Ips:IpService:service', 
	  '0', 
	  'An Internet service');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Site', 
	  'name', 
	  'name,number,aliases,street1,street2,pobox,city,state,zip,country,availability,contactlist,info', 
	  'name,number,street1,city', 
	  'name:Name,number:Site ID,aliases:Aliases,street1:Street (1),street2:Street (2),pobox:P.O. Box,city:City,state:State,zip:Zip/Postal Code,country:Country,availability:Availability,contactlist:Contact Group,info:Comments',
	  '',
	  'availability:Availability,contactlist:ContactList', 
	  'nearconnections:Connection:nearend,farconnections:Connection:farend,entities:EntitySite:site,devices:Device:site:{on_delete=>"set-null"},people:Person:location:{on_delete=>"set-null"},floors:Floor:site,closets:Closet:site', 
	  '0', 
	  'A Physical location');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('Splice', 'strand1,strand2',  'strand1,strand2', 'strand1,strand2', 'strand1:CableStrand,strand2:CableStrand', '', '0', 'Cable Splices');


INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('StrandStatus', 'name',  'name', 'name', '', 'strands:CableStrand:status:{on_delete=>"restrict"}', '0', 'Cable strand/pair status');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, linksto, linksfrom, isjoin, description)
  VALUES ('SubnetZone', 
	  'subnet,zone', 
	  'subnet,zone,', 
	  'subnet,zone', 
	  'subnet:Ipblock,zone:Zone', 
	  '', 
 	  '1', 
	  'IP Subnet to DNS Zone join table');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Vlan', 
	  'vid', 
	  'vid,subnet,description,info', 
	  'vid',
	  'vid:VLAN ID,subnet:Subnet,description:Description,info:Comments',
	  '',
	  'subnet:Ipblock', 
	  'interfaces:InterfaceVlan:vlan', 
	  '0', 
	  'A Virtual LAN');

INSERT INTO Meta (name, label, columnorder, columnorderbrief, columntags, columndescr, linksto, linksfrom, isjoin, description)
  VALUES ('Zone', 
	  'mname', 
	  'mname,rname,serial,refresh,retry,expire,minimum,contactlist,active,reverse,masterserver,info', 
	  'mname,masterserver',
	  'mname:Domain Name,rname:Mail Box,serial:Serial,refresh:Refresh,retry:Retry,expire:Expire,minimum:Minimum,contactlist:Contact List,active:Active?,reverse:Reverse?,masterserver:Master Server,info:Comments',
	  '',
	  'contactlist:ContactList,masterserver:IpService', 
	  'records:RR:zone:{on_delete=>"restrict"},subnets:SubnetZone:zone', 
	  '0', 
	  'A DNS Zone');


$inserttypes

END
close(TMP);

print "Enter the password for the database user $DB_DBA.\n";
system ("$BINDIR/mysql --user=$DB_DBA $DB_DATABASE -p < $TMP");

system ("rm -f $TMP");
